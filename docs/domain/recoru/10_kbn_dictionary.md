# 10_kbn_dictionary.md - 勤務区分辞書（最重要）

## このファイルの目的
勤務区分（勤怠種別）の定義・判断基準を一元管理する

## 対象読者
- RPA開発者（入力値の決定）
- 運用担当者（判断基準の確認）
- 問い合わせ対応者（回答の根拠）

## 更新ルール
- **正本**: このファイルが勤務区分の定義の正本
- **マスタとの関係**: `kbn_master.csv` はシステム用。人間が読む定義・判断基準はここに書く
- **追記**: 新規区分は末尾に追加。既存定義の変更は「変更履歴」セクションに記録

---

## 1. 勤務区分一覧（辞書テーブル）

### 1.1 通常勤務系

| 区分コード | 区分名 | 意味 | 使う条件 | RPA入力値 | 例外・注意 | よくある誤り |
|-----------|--------|------|---------|-----------|-----------|-------------|
| TBD | 通常出勤 | 通常の出勤 | 所定労働日に出勤 | TBD | なし | - |
| TBD | 遅刻 | 始業時刻より遅れて出勤 | 始業時刻を過ぎて打刻 | TBD | 承認済み遅刻は除外 | 電車遅延証明ありの場合 |
| TBD | 早退 | 終業時刻より早く退勤 | 終業時刻前に退勤打刻 | TBD | 承認済み早退は除外 | 半休との混同 |

### 1.2 休暇系

| 区分コード | 区分名 | 意味 | 使う条件 | RPA入力値 | 例外・注意 | よくある誤り |
|-----------|--------|------|---------|-----------|-----------|-------------|
| TBD | 有給休暇 | 年次有給休暇（全日） | 有休申請が承認済み | TBD | 残日数チェック必要 | 半休との混同 |
| TBD | 有給半休（午前） | 有休半日（午前） | 午前半休申請が承認済み | TBD | 午後は出勤 | 全日有休との混同 |
| TBD | 有給半休（午後） | 有休半日（午後） | 午後半休申請が承認済み | TBD | 午前は出勤 | 全日有休との混同 |
| TBD | 公休 | 会社指定の休日 | カレンダー上の公休日 | TBD | 休日出勤時は別区分 | 有休との混同 |
| TBD | 振替休日 | 休日出勤の振替 | 振休申請が承認済み | TBD | 振替元の休日出勤が必要 | 代休との混同 |
| TBD | 代休 | 休日出勤後の休暇 | 代休申請が承認済み | TBD | 振休との違いを理解 | 振休との混同 |
| TBD | 特別休暇 | 慶弔等の特別休暇 | 特休申請が承認済み | TBD | 種別ごとに日数上限あり | 有休との混同 |

### 1.3 残業系

| 区分コード | 区分名 | 意味 | 使う条件 | RPA入力値 | 例外・注意 | よくある誤り |
|-----------|--------|------|---------|-----------|-----------|-------------|
| TBD | 残業 | 所定外労働 | 終業後の勤務 | TBD | 事前申請要否確認 | 深夜残業との区別 |
| TBD | 深夜残業 | 22:00〜5:00の勤務 | 深夜帯の勤務 | TBD | 割増率が異なる | 通常残業との混同 |
| TBD | 休日出勤 | 公休日の勤務 | 公休日に出勤 | TBD | 振休/代休対象 | 通常出勤との混同 |

### 1.4 その他

| 区分コード | 区分名 | 意味 | 使う条件 | RPA入力値 | 例外・注意 | よくある誤り |
|-----------|--------|------|---------|-----------|-----------|-------------|
| TBD | 欠勤 | 無届の休み | 申請なしの休み | TBD | 給与控除対象 | 有休との混同 |
| TBD | 出張 | 社外での業務 | 出張申請が承認済み | TBD | 打刻方法が異なる場合あり | - |
| TBD | 在宅勤務 | 自宅での勤務 | 在宅申請が承認済み | TBD | 打刻方法確認 | - |

---

## 2. 判断フローチャート

### 2.1 休暇系の判断

```
申請あり？
├─ YES → 承認済み？
│         ├─ YES → 申請種別に応じた区分を適用
│         │         ├─ 有休申請 → 有給休暇
│         │         ├─ 振休申請 → 振替休日
│         │         ├─ 代休申請 → 代休
│         │         └─ 特休申請 → 特別休暇
│         └─ NO  → 申請中 or 差戻し（処理対象外）
│
└─ NO  → カレンダー上の休日？
          ├─ YES → 公休
          └─ NO  → 欠勤（要確認）
```

### 2.2 出勤系の判断

```
打刻あり？
├─ YES → 出勤打刻時刻 vs 始業時刻
│         ├─ 遅刻 → 遅刻届あり？ → YES: 通常出勤 / NO: 遅刻
│         └─ 正常 → 通常出勤
│
└─ NO  → 休暇系の判断へ
```

---

## 3. 振休と代休の違い（重要）

| 項目 | 振替休日（振休） | 代休 |
|------|----------------|------|
| 申請タイミング | 休日出勤**前**に申請 | 休日出勤**後**に申請 |
| 給与計算 | 休日割増なし | 休日割増あり |
| 期限 | 同一週内が原則 | 会社規定による |
| レコル入力 | TBD | TBD |

---

## 4. マスタファイルとの対応

### 4.1 正本マスタ
```
C:\ProgramData\RK10\Robots\47出退勤確認\config\kbn_master.csv
```

### 4.2 マスタ構造（参考）

| カラム名 | 型 | 説明 |
|---------|-----|------|
| kbn_code | string | 区分コード |
| kbn_name | string | 区分名（表示用） |
| TBD | TBD | TBD |

---

## 5. 変更履歴

| 日付 | 変更内容 | 変更者 |
|------|---------|--------|
| 2026-01-17 | 初版作成（テンプレート） | Claude |

---

## 次に埋めるべき項目
1. [ ] 1.1〜1.4 の全テーブル - kbn_master.csvから実データを転記
2. [ ] 2.1, 2.2 の判断フロー - 実運用に合わせて修正
3. [ ] 3. 振休と代休の違い - RPA入力値を確定
4. [ ] 4.2 マスタ構造 - 実際のCSV構造を反映
