# Template: 客先引継ぎ資料（非エンジニア向け）

## 概要
客先（非エンジニア）に渡す運用・引継ぎ資料のテンプレート。
「運用担当が読む範囲」と「証跡/技術付録」を明確に分離。

---

## 資料構成の考え方

| パート | 対象読者 | 読了時間 | 目的 |
|--------|----------|----------|------|
| **A. 本編** | 運用担当 | 5〜10分 | 日常運用に必要な情報のみ |
| **B. 証跡パート** | 監査/管理者 | 必要時参照 | 「言われた通り作った」の担保 |
| **C. 付録** | 保守担当/開発者 | 必要時参照 | 技術詳細・変更時の参考 |

---

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# A. 本編（運用担当が読む範囲：5〜10分で理解）
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## A-1. 1分サマリー

### 目的
[このロボットで何を達成するか、1〜2文で]

### できること
- [機能1]
- [機能2]
- [機能3]

### 成果物
| 成果物 | 保存場所 |
|--------|----------|
| [出力ファイル名] | `\\server\share\output\` |

### 運用担当の役割
**運用担当の作業は原則「実行→結果確認」のみです。**
- ロボットを実行する
- 完了通知を確認する
- 出力ファイルを確認する
- エラー時は一次対応後、開発担当へ連絡

---

## A-2. 導入効果（Before/After）

### 導入前（手作業）
| 工程 | 作業内容 | 所要時間 | 頻度 |
|------|----------|----------|------|
| 1 | [手作業内容1] | [X]分 | [月X回] |
| 2 | [手作業内容2] | [X]分 | [月X回] |
| 3 | [手作業内容3] | [X]分 | [月X回] |
| **合計** | | **[XX]分/月** | |

### 導入後（ロボット）
| 工程 | 作業内容 | 所要時間 | 頻度 |
|------|----------|----------|------|
| 1 | ロボット実行 | 1分 | [月X回] |
| 2 | 結果確認 | 2分 | [月X回] |
| **合計** | | **3分/月** | |

### 削減効果
- **作業時間**: [XX]分/月 → 3分/月（**[XX]%削減**）
- **人的ミス**: 手入力によるミスリスク排除

---

## A-3. 処理フロー（To-Be概要）

```
[処理開始]
    ↓
[1. ログイン]
    ↓
[2. データ取得]
    ↓
[3. データ変換]
    ↓
[4. Excel出力]
    ↓
[5. 保存・通知]
    ↓
[処理完了]
```

---

## A-4. 入出力・保存場所（最重要）

### 入力ファイル
| ファイル | パス（本番） | 説明 |
|----------|-------------|------|
| [入力ファイル1] | `\\server\share\input\file.csv` | [説明] |
| 設定ファイル | `C:\ProgramData\RK10\Robots\XX\config\RK10_config_PROD.xlsx` | 環境設定 |

### 出力ファイル
| ファイル | パス（本番） | 説明 |
|----------|-------------|------|
| [出力ファイル1] | `\\server\share\output\result_YYYYMM.xlsx` | [説明] |
| ログファイル | `C:\ProgramData\RK10\Robots\XX\logs\main.log` | 処理ログ |

### 作業フォルダ
| フォルダ | パス | 説明 |
|----------|------|------|
| 一時作業 | `C:\ProgramData\RK10\Robots\XX\work\` | 処理中の一時ファイル |

---

## A-5. 運用手順（非エンジニア用）

### 前提条件
- [ ] VPN接続済み
- [ ] Windows資格情報マネージャーに認証情報登録済み
- [ ] `config\env.txt` が `PROD` になっている

### 月次運用手順

#### Step 1: 実行
1. RK10を起動
2. `C:\ProgramData\RK10\Robots\XX\scenario\main.rks` を開く
3. 「編集しますか？」→「はい」をクリック
4. 実行ボタン（▶）をクリック

#### Step 2: 完了確認
1. 画面に「処理完了」と表示されることを確認
2. 完了通知メールを確認（送信設定がある場合）

#### Step 3: 結果確認
1. 出力フォルダ `\\server\share\output\` を開く
2. 本日日付のファイルが作成されていることを確認
3. ファイルを開き、データが正しく転記されていることを確認

---

## A-6. エラー時の一次対応

### エラー発生時の確認手順

#### Step 1: エラー内容の確認
1. RK10のエラーダイアログを確認
2. 「コピー」ボタンでエラー内容をコピー
3. ログファイル `C:\ProgramData\RK10\Robots\XX\logs\main.log` を確認

#### Step 2: よくあるエラーと対応

| エラー | 原因 | 対応 |
|--------|------|------|
| ログインエラー | 資格情報の期限切れ | 資格情報マネージャーで更新 |
| ファイルが見つからない | 入力ファイル未準備 | 入力フォルダにファイルを配置 |
| タイムアウト | VPN切断/サーバー障害 | VPN再接続後、再実行 |
| 10回リトライ失敗 | ファイルロック | 作業フォルダをクリア後、再実行 |

#### Step 3: 復旧できない場合
以下を添えて開発担当へ連絡:
- エラー発生日時
- エラーメッセージ（コピーしたもの）
- ログファイル
- 実行時のスクリーンショット

**連絡先**: [担当者名] / [メールアドレス] / [電話番号]

---

## A-7. 通知仕様

### 完了通知メール
| 項目 | 内容 |
|------|------|
| 送信条件 | 処理正常完了時 |
| 宛先 | [to@example.com] |
| CC | [cc@example.com] |
| 件名 | 【完了】[ロボット名] YYYY/MM/DD |
| 本文 | 処理が正常に完了しました。出力ファイル: [パス] |
| 添付 | なし |

### エラー通知メール
| 項目 | 内容 |
|------|------|
| 送信条件 | 処理異常終了時 |
| 宛先 | [admin@example.com] |
| 件名 | 【エラー】[ロボット名] YYYY/MM/DD |
| 本文 | エラーが発生しました。詳細はログを確認してください。 |
| 添付 | エラーログ |

---

## A-8. 運用担当の役割分担

### やること
- [x] ロボットの実行（月次/指定日）
- [x] 完了通知の確認
- [x] 出力ファイルの存在確認
- [x] エラー時の一次対応（上記手順に従う）
- [x] 復旧不能時の開発担当への連絡

### やらないこと
- [ ] シナリオファイル（.rks）の編集
- [ ] 設定ファイルの変更（開発担当に依頼）
- [ ] Pythonスクリプトの修正
- [ ] エラーの原因調査（一次対応で復旧しない場合）

---

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# B. 証跡パート（監査・後出し説明用）
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## B-1. 要件トレーサビリティ

### 機能要件

| 要件ID | 要件名 | 実装根拠 | テストケースID | 結果 |
|--------|--------|----------|---------------|------|
| F-001 | ログイン | main.rks Step 1-5 | TC-001 | PASS |
| F-002 | データ取得 | main.rks Step 6-10 | TC-002 | PASS |
| F-003 | データ変換 | converter.py | TC-003 | PASS |
| F-004 | Excel出力 | excel_writer.py | TC-004 | PASS |
| F-005 | 保存 | main.rks Step 20-25 | TC-005 | PASS |
| F-006 | 完了通知 | notification.py | TC-006 | PASS |
| F-007 | エラー通知 | notification.py | TC-007 | PASS |

### 非機能要件

| 要件ID | 要件名 | 実装根拠 | テストケースID | 結果 |
|--------|--------|----------|---------------|------|
| NF-001 | 実行時間 | - | TC-NF-001 | PASS（3分12秒） |
| NF-002 | リトライ | main.rks リトライループ | TC-NF-002 | PASS |
| NF-003 | ログ出力 | logging設定 | TC-NF-003 | PASS |
| NF-004 | 認証方式 | 資格情報マネージャー | TC-NF-004 | PASS |
| NF-005 | 環境切替 | env.txt + config | TC-NF-005 | PASS |

---

## B-2. テスト結果

### テストケース一覧

| テストケースID | テスト内容 | 期待結果 | 実施日 | 結果 | エビデンス |
|---------------|-----------|----------|--------|------|-----------|
| TC-001 | ログイン成功 | ログイン後の画面表示 | 2026/01/20 | PASS | screenshot_001.png |
| TC-002 | データ取得 | CSVダウンロード完了 | 2026/01/20 | PASS | download_log.txt |
| TC-003 | データ変換 | 変換後データ件数一致 | 2026/01/20 | PASS | convert_log.txt |
| TC-004 | Excel出力 | 出力ファイル作成 | 2026/01/20 | PASS | output_202501.xlsx |
| TC-005 | 保存 | 指定フォルダに保存 | 2026/01/20 | PASS | folder_screenshot.png |
| TC-006 | 完了通知 | メール受信 | 2026/01/20 | PASS | mail_screenshot.png |
| TC-007 | エラー通知 | エラーメール受信 | 2026/01/20 | PASS | error_mail.png |

### エビデンス格納場所
`\\server\share\docs\evidence\` または `C:\ProgramData\RK10\Robots\XX\docs\evidence\`

---

## B-3. 成果物一覧（納品物）

| No | 種別 | ファイル名 | パス | 説明 |
|----|------|-----------|------|------|
| 1 | シナリオ | main.rks | `C:\ProgramData\RK10\Robots\XX\scenario\` | メインシナリオ |
| 2 | スクリプト | main.py | `C:\ProgramData\RK10\Robots\XX\tools\` | エントリーポイント |
| 3 | スクリプト | scraper.py | `C:\ProgramData\RK10\Robots\XX\tools\` | スクレイピング処理 |
| 4 | スクリプト | converter.py | `C:\ProgramData\RK10\Robots\XX\tools\` | データ変換処理 |
| 5 | スクリプト | excel_writer.py | `C:\ProgramData\RK10\Robots\XX\tools\` | Excel出力処理 |
| 6 | 設定 | env.txt | `C:\ProgramData\RK10\Robots\XX\config\` | 環境切替 |
| 7 | 設定 | RK10_config_PROD.xlsx | `C:\ProgramData\RK10\Robots\XX\config\` | 本番環境設定 |
| 8 | 設定 | RK10_config_LOCAL.xlsx | `C:\ProgramData\RK10\Robots\XX\config\` | ローカル環境設定 |
| 9 | マスタ | master.csv | `C:\ProgramData\RK10\Robots\XX\config\` | マスタデータ |
| 10 | ドキュメント | 要件定義書.xlsx | `C:\ProgramData\RK10\Robots\XX\docs\` | 要件定義書 |
| 11 | ドキュメント | 運用手順書.md | `C:\ProgramData\RK10\Robots\XX\docs\` | 本資料 |

---

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# C. 付録（保守担当が読む範囲）
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## C-1. 詳細手順（PDD）

※別紙「要件定義書.xlsx」シート9「PDD詳細手順」を参照

---

## C-2. 設計思想

### アーキテクチャ

```
RK10シナリオ（.rks）
    ├── env.txt読み込み（PROD/LOCAL判定）
    ├── 設定ファイル読み込み（RK10_config_*.xlsx）
    ├── Python呼び出し（main.py）
    │     ├── スクレイピング処理（Playwright）
    │     ├── データ変換処理
    │     └── Excel出力（openpyxl）
    ├── 結果確認
    └── 完了/エラー通知
```

### 設計方針
- **ハードコード禁止**: 日付・パス等は設定ファイル化
- **リトライ**: 失敗時は最大10回リトライ
- **環境切替**: env.txtでPROD/LOCAL切替
- **例外停止**: 異常検知時は即座に停止・通知

---

## C-3. 外部IF・制約

### 外部システム
| システム名 | URL | 認証方式 | 制約 |
|-----------|-----|---------|------|
| [システム名] | `https://xxx.example.com` | ID/PW | メンテナンス時間あり |

### 制約事項
1. [システム名]のメンテナンス時間（日曜2:00-6:00）は実行不可
2. VPN接続が必要
3. 月末締め処理中はデータ取得不可

---

## C-4. ログ・証跡の場所

| 種別 | パス | 内容 |
|------|------|------|
| 処理ログ | `C:\ProgramData\RK10\Robots\XX\logs\main.log` | 処理開始/終了/エラー |
| RK10ログ | `C:\ProgramData\RK10\Logs\` | RK10標準ログ |
| エラーログ | `C:\ProgramData\RK10\Robots\XX\logs\error.log` | エラー詳細 |

### ログの見方
```
2026-01-20 10:00:00 [INFO] 処理開始: env=PROD, month=202501
2026-01-20 10:00:05 [INFO] ログイン完了
2026-01-20 10:00:30 [INFO] データ取得完了: 150件
2026-01-20 10:01:00 [INFO] Excel出力完了: output_202501.xlsx
2026-01-20 10:01:05 [INFO] 処理正常終了
```

---

## 改訂履歴

| 版 | 日付 | 変更内容 | 作成者 |
|----|------|----------|--------|
| 1.0 | 2026/01/20 | 初版作成 | [作成者名] |
| 1.1 | 2026/01/25 | エラー対応追加 | [作成者名] |
