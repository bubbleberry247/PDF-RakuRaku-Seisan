# handoff.md（短く・上書き前提）

## Current focus
- **シナリオ55 15日25日末日振込エクセル作成** - 担当者確認事項整理完了、確認待ち

## Done (今回セッション)
- シナリオ55の現状確認
- Excel書き起こし確認（`C:\Users\masam\Desktop\KeyenceRK\20251201RPAロボット手順詳細.xlsx` シート55）
- 詳細業務フロー整理（全25ステップ）
- **人間確認タイミング整理**:
  - RPA処理後に人間確認（A.未登録支払先の業者番号記入、B.科目確認・修正、C.支払先計調整、D.合計照合、E.上書き保存）
  - 設計思想:「人間の判断を代替する」ではなく「人間が判断しやすい状態を作る」
- **担当者確認事項リスト作成**（全22項目）:
  - 高優先: 科目使い分けルール、未登録支払先処理、シート名リネームルール、摘要省略ルール
  - 中優先: 計算式入りテンプレート準備、本番ファイル直接保存 or 作業用コピー
  - 低優先: 実行スケジュール詳細、総合振込以外の処理
- **PPTX出力**: `C:\ProgramData\RK10\Robots\55 １５日２５日末日振込エクセル作成\docs\55_人間確認タイミング.pptx`（A4縦3ページ）

## Done (過去セッション)
- シナリオ55 Python実装完了（main.py, rakuraku_scraper.py, excel_writer.py）
- RKSシナリオ作成済み（５５_自動化版_v2_mailfix.rks）
- テスト実行済み（28件中17件転記成功、77.3%）
- シナリオ43 ETC明細作成 一時停止（ExternalResourceReader問題）

## Next (top 3)
1. **シナリオ55 担当者確認**: PPTXの確認事項を吉田さんに確認
2. **シナリオ55 本番運用開始**: 確認事項回答後、本番環境でテスト実行
3. **シナリオ43 再開**: ExternalResourceReader問題の根本解決

## Risks
- シナリオ55: 科目の使い分けルールが明確でない場合、人間確認の負荷が高い
- シナリオ55: 未登録支払先が多い月は6799行が不足する可能性

## Relevant files
### シナリオ55関連
| ファイル | 用途 |
|---------|------|
| `C:\ProgramData\RK10\Robots\55 １５日２５日末日振込エクセル作成\docs\55_人間確認タイミング.pptx` | **担当者確認用資料（A4縦3ページ）** |
| `C:\ProgramData\RK10\Robots\55 １５日２５日末日振込エクセル作成\docs\55_振込Excel転記_工程手順書.md` | 工程手順書（v1.0） |
| `C:\ProgramData\RK10\Robots\55 １５日２５日末日振込エクセル作成\docs\55_振込Excel転記_設計書.md` | 設計書（v1.0） |
| `C:\Users\masam\Desktop\KeyenceRK\20251201RPAロボット手順詳細.xlsx` | **業務フロー書き起こし元（シート55）** |
| `\\172.20.0.70\ユニオン共有\★公開フォルダ\吉田さん閲覧フォルダ\5F\3建設事業部\東海インフル建設(株)\☆総合振込\総合振込計上・支払伝票.xlsx` | 転記先Excel（本番） |

### シナリオ55 RKS/ツール
| ファイル | 状態 |
|---------|------|
| `scenario\５５_自動化版_v2_mailfix.rks` | 最新版 |
| `tools\main.py` | メイン制御 |
| `tools\rakuraku_scraper.py` | 楽楽精算スクレイピング |
| `tools\excel_writer.py` | Excel転記処理 |

### シナリオ55 担当者確認事項（優先度高）
| No | 確認事項 | 現在の仮実装 |
|----|---------|-------------|
| 3-1 | 科目の使い分けルール？ | 既存行の科目を使用（人間確認必須） |
| 4-1 | 未登録支払先の処理方法？ | 6799行に転記（業者番号空欄） |
| 1-2 | シート名リネームルール？ | R{和暦}.{月}月分を自動生成 |
| 2-2 | 摘要の省略ルール？ | 省略なし（そのまま転記） |
